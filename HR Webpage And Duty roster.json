{"files":[{"id":"e9522e6e-4d64-4319-ae09-4863cc3fabf5","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"Asia/Singapore\",\n  \"dependencies\": {},\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"webapp\": {\n    \"executeAs\": \"USER_DEPLOYING\",\n    \"access\": \"ANYONE_ANONYMOUS\"\n  }\n}"},{"id":"7461ad6b-a01a-4098-acb0-a36b35ca6eec","name":"Code","type":"server_js","source":"var url \u003d \"https://docs.google.com/spreadsheets/d/1wlHjWqgISlEafh7ytvIwSkXl0hCoroGsTNiyRCuEeHU/edit?resourcekey\u003d\u0026gid\u003d291890891#gid\u003d291890891\";\n\n function doGet(e) {\n  var ss \u003d SpreadsheetApp.openByUrl(url);\n  var ws \u003d ss.getSheetByName(\"Form Responses 1\");\n  var list \u003d ws.getRange(1,10,ws.getRange(\"J2\").getDataRegion().getLastRow(),1).getValues();\n\n  var template \u003d HtmlService.createTemplateFromFile(\u0027index\u0027);\n  template.list \u003d list;\n  var output \u003d template.evaluate();\n  return output;\n\n  //return HtmlService.createHtmlOutputFromFile(\u0027index\u0027);\n}\n\nfunction getDataFromSheet() {\n  var ss \u003d SpreadsheetApp.openByUrl(url);\n  var ws \u003d ss.getSheetByName(\"Form Responses 1\");\n  var list \u003d ws.getRange(2,10,ws.getRange(\"J2\").getDataRegion().getLastRow(),1).getValues();\n\n  var currentMonth \u003d new Date().getMonth() + 1; // Get the current month (1-indexed)\n  //var currentYear \u003d new Date().getFullYear();\n\n  console.log(currentMonth);\n\n  // Create HTML content\n  var htmlContent \u003d \u0027\u003ctable\u003e\u003ctbody\u003e\u0027;\n  for (var i \u003d 0; i \u003c list.length; i++) {\n    var value \u003d String(list[i]);\n    if (value.trim() !\u003d\u003d \"\") { \n      htmlContent +\u003d \u0027\u003ctr\u003e\u003ctd\u003e\u0027 + list[i] + \u0027\u003c/td\u003e\u003c/tr\u003e\u0027;\n    }\n  }\n  htmlContent +\u003d \u0027\u003c/tbody\u003e\u003c/table\u003e\u0027;\n\n  return htmlContent;\n}\n\n\n\nfunction getGoogleFormLink() {\n  return \"https://docs.google.com/forms/d/e/1FAIpQLScLCKdCrKIG3JwTkFDEwgqxassXQKq87mf5-iMMU9wTn1Dw_Q/viewform\"; \n}\n\n"},{"id":"c147a9a2-fb13-4e06-ba9d-5dae90e70fb9","name":"index","type":"html","source":"\u003c!DOCTYPE html\u003e\n\u003chtml lang\u003d\"en\"\u003e\n\u003chead\u003e\n  \u003cmeta charset\u003d\"UTF-8\"\u003e\n  \u003cmeta name\u003d\"viewport\" content\u003d\"width\u003ddevice-width, initial-scale\u003d1.0\"\u003e\n  \u003ctitle\u003eHuman Resources Website\u003c/title\u003e\n\n  \u003cstyle\u003e\n    body {\n      font-family: \u0027Courier New\u0027, Courier, monospace;\n      background-image: url(\u0027https://imagizer.imageshack.com/img922/7672/lknsoC.jpg\u0027); \n      background-size: cover; \n      margin: 0;\n      padding: 0;\n    }\n\n\n    .header {\n      color: white;\n      border: none;\n      font-size: 30px;\n      font-weight: bold;\n      background-color: rgba(255, 255, 255, 0.25);\n      height: 40px;\n      padding-left: 10px;\n      text-shadow: 1.5px 1.5px pink;\n      display: flex;\n      align-items: center;\n    }\n\n    .teamlogo {\n      display: flex;\n      align-items: center;\n    }\n\n    .logo-image {\n      width: 42px; \n      height: auto;\n      margin-right: 10px;\n    }\n\n    .leavelogo{\n      width:auto;\n      height:150px;\n\n    }\n\n    .logo {\n      font-size: 30px;\n      font-weight: bold;\n      color: white;\n    }\n\n    section.parent-of-header {\n      margin: 0;}\n\n\n    .content {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      height: auto;\n      width:1200px;\n      background-color: rgba(255, 255, 255, 0.25);\n      border-radius: 20px;\n      padding: 30px;\n      margin-top: 50px;\n      gap:25px;\n    }\n\n    .duty {\n      display: flex;\n      flex-direction: column;\n      justify-content: space-between;\n    }\n\n    .leave {\n      display: flex;\n      flex-direction: column;\n      justify-content: space-between;\n      align-items: center;\n      text-align: justify; \n      height: 100%; \n    }\n\n    .warning ul li {\n      border:none;\n    }\n\n    button {\n      background-color: rgba(255,255,255,0.3);\n      color: white;\n      text-align: center;\n      text-decoration: none;\n      font-size: 20px;\n      margin: 4px 2px;\n      width: 300px;\n      height:50px;\n      border-radius: 20px;\n      border:none;\n      font-family: \u0027Courier New\u0027, Courier, monospace;\n    }\n\n    button:hover {\n      transform: scale(1.05);\n      cursor: pointer;\n      color:pink;\n      text-decoration:underline;\n    }\n\n    .warning {\n      font-family:\u0027Courier New\u0027, Courier, monospace;\n      color:white;\n      text-align:justify;\n      font-size:16px;\n    }\n    .warning li {\n      margin-bottom: 15px; \n    }\n\n    .MAOWEI {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n\n    .hdk {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n\n    .sheet {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      height: fit-content;\n      width:1200px;\n      background-color: rgba(255, 255, 255, 0.25);\n      border-radius: 20px;\n      padding: 30px;\n      margin: 60px 0px;\n      width: 1200px;\n      height: 280px;\n      flex-direction:column;\n    }\n\n    .sheetwarning{\n      margin:0px;\n      padding:0px;\n      color:white;\n\n    }\n\n    #duty {\n      \n      width: 100%;\n      height: 100%;\n      border: none;\n    }\n\n\n    @media (max-width: 1200px) {\n      .content, .sheet {\n        padding: 20px;\n        gap: 20px;\n      }\n    }\n\n    @media (max-width: 992px) {\n      .content, .sheet {\n        padding: 15px;\n        flex-direction: column;\n        gap: 15px;\n      }\n      button {\n        width: 100%;\n      }\n      .leave .warning ul {\n        padding: 0;\n      }\n    }\n\n    @media (max-width: 768px) {\n      .content, .sheet {\n        padding: 10px;\n        gap: 10px;\n      }\n      .header {\n        font-size: 24px;\n      }\n      .logo {\n        font-size: 24px;\n      }\n    }\n\n    @media (max-width: 576px) {\n      .content, .sheet {\n        padding: 5px;\n        gap: 5px;\n      }\n      button {\n        font-size: 16px;\n        height: 40px;\n      }\n      .header {\n        font-size: 20px;\n      }\n      .logo {\n        font-size: 20px;\n      }\n      .warning {\n        font-size: 14px;\n      }\n    }\n  \u003c/style\u003e\n\n\u003c/head\u003e\n\n\u003cbody\u003e\n\n  \u003csection class\u003d\"header\"\u003e\n    \u003cdiv class\u003d\"teamlogo\"\u003e\n      \u003cimg src\u003d\"https://imagizer.imageshack.com/img923/876/i7Xt6p.png\" alt\u003d\"capybara\" class\u003d\"logo-image\"\u003e\n      \u003cspan class\u003d\"logo\"\u003eCyberCapybara\u003c/span\u003e\n    \u003c/div\u003e\n  \u003c/section\u003e\n\n\n  \u003csection id \u003d \"Annoucements\"\u003e\n      \u003ch2\u003eAnnoucements\u003c/h2\u003e\n      \u003cstyle\u003e\n    \n        #Annoucements {\n          padding:30px;\n\n          \n        }\n\n        #Annoucements h2 {\n          font-size: 36px;\n          color: white; \n          margin-bottom: 15px;\n          text-align: center; \n        }\n\n        table {\n          \n          width: 100%;\n          border-collapse: collapse;\n          margin-bottom: 0px;\n        }\n\n        th, td {\n          border: 1px solid white; /* Border color to white */\n          padding: 8px;\n          color: white; /* Text color to white */\n          text-align:center;\n        }\n\n        tr:nth-child(even) {\n          background-color: rgba(0, 0, 0, 0.2); /* Black with 40% opacity */\n        }\n\n        tr:hover {\n          background-color: #da8ee7; /* Hover effect for rows */\n        }\n\n        ul {\n          list-style-type: none;\n          padding-left: 0;\n        }\n\n        ul li {\n          padding: 8px 0;\n          border-bottom: 1px solid white; /* Border color to white */\n          color: white; /* Text color to white */\n        }\n\n        ul li::before {\n          content: \"\\2022\";\n          color: white; \n          display: inline-block;\n          width: 1em;\n          margin-left: -1em;\n        }\n    \u003c/style\u003e\n      \n      \u003cdiv id\u003d\"tableContainer\"\u003e\u003c/div\u003e\n        \u003cscript\u003e\n          google.script.run\n            .withSuccessHandler(function(htmlContent) {\n              document.getElementById(\u0027tableContainer\u0027).innerHTML \u003d htmlContent;\n            })\n            .getDataFromSheet();\n            \n        \u003c/script\u003e\n    \u003c/section\u003e\n\n\n\n  \u003cdiv class\u003d\"MAOWEI\"\u003e\n      \u003cdiv class\u003d\"content\"\u003e\n        \u003cdiv class\u003d\"duty\"\u003e\n          \u003ciframe src\u003d\"https://calendar.google.com/calendar/embed?height\u003d400\u0026wkst\u003d1\u0026ctz\u003dAsia%2FKuala_Lumpur\u0026bgcolor\u003d%23ffffff\u0026showPrint\u003d0\u0026showTabs\u003d0\u0026showTz\u003d0\u0026src\u003dY2FieWJhcmFjeWJlckBnbWFpbC5jb20\u0026src\u003dYmZmOGVkM2VmYWY5NzNjNGRmNjZlNWYwZmE5MmEzZWIwM2E0YTM3NWNmYjM4ZmJhNzQ0OTFjYzk2ZDAwMjEyMkBncm91cC5jYWxlbmRhci5nb29nbGUuY29t\u0026color\u003d%23039BE5\u0026color\u003d%23D50000\" style\u003d\"border:solid 1px #777\" width\u003d\"700\" height\u003d\"400\" frameborder\u003d\"0\" scrolling\u003d\"no\"\u003e\u003c/iframe\u003e\n        \u003c/div\u003e\n\n        \u003cdiv class\u003d\"leave\"\u003e\n          \u003cimg src\u003d\"https://imagizer.imageshack.com/img923/876/i7Xt6p.png\" alt\u003d\"capybara\" class\u003d\"leavelogo\"\u003e\n          \u003cdiv class\u003d\"warning\"\u003e\n            \u003cul\u003e\n              \u003cli\u003e Apply for leave at least 1 week in advance unless it is an emergency.\u003c/li\u003e\n              \u003cli\u003eMedical leave will be given top priority.\u003c/li\u003e\n              \u003cli\u003eOnly two employees may be on leave per day\u003c/li\u003e\n              \u003cli\u003eLeave on Saturdays and Sundays is not permitted unless it\u0027s an emergency\u003c/li\u003e\n            \u003c/ul\u003e\n          \u003c/div\u003e\n          \u003cbutton onclick\u003d\"openGoogleForm()\"\u003eApply for Leave\u003c/button\u003e\n        \u003c/div\u003e\n      \u003c/div\u003e\n  \u003c/div\u003e\n\n  \u003cdiv class\u003d\"hdk\"\u003e\n    \u003cdiv class\u003d\"sheet\"\u003e\n      \u003ciframe id\u003d\"duty\" src\u003d\"https://docs.google.com/spreadsheets/d/e/2PACX-1vSqit-TGM4RXlxFRcivS15q64M1CMf3wvUogDiCdxPYXGU-AtgRlwfrOGis1nn--vcM6MiE0IPbmONe/pubhtml?gid\u003d0\u0026amp;single\u003dfalse\u0026amp;widget\u003dfalse\u0026amp;headers\u003dfalse\"\u003e\u003c/iframe\u003e\n      \u003cdiv class\u003d\"sheetwarning\"\u003e\n      \u003cp\u003e *F \u003d 10am-10pm ||  M \u003d 10am-8pm || A1 \u003d 12pm-10pm \u003c/p\u003e\n    \u003c/div\u003e\n    \u003c/div\u003e\n    \n  \u003c/div\u003e\n\n\n  \u003cscript\u003e\n    function getDutyRoster() {\n      google.script.run.withSuccessHandler(function(roster) {\n        document.getElementById(\u0027duty-roster-content\u0027).innerHTML \u003d roster;\n      }).getDutyRoster();\n    }\n\n    function openGoogleForm() {\n      google.script.run.withSuccessHandler(function(formLink) {\n        window.open(formLink, \u0027_blank\u0027);\n      }).getGoogleFormLink();\n    }\n\n  \n\n  \u003c/script\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"}]}